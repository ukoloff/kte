# Генерация G-кода

Данная утилита командной строки реализует
[Технологический алгоритм](../lathe/),
то есть по набору КТЭ строит
управляющие программы
(G-код).

## Сборка

Сборка и тестирование утилиты
производятся одновременно с [другими модулями](.),
использующими язык JavaScript
на платформе Node.js

## Запуск утилиты

В процессе разработки утилита запускается командой вида
```sh
node kte <файл-задание.txt> <список КТЭ.xml>
```
где kte - путь к папке репозитория,
содержащей исходные коды.
В частности, непосредственно из папки репозитория
она может запускаться как
```sh
node . <файл-задание.txt> <список КТЭ.xml>
```

Исходные файлы могут указываться в любом порядке.
Файлы с полученными управляющими программами
будут
(на время разработки)
помещены в
`bundle/задание-01.nc`
и
`bundle/задание-02.nc`.


## Настройки

Для настройки утилиты используется файл
`.env`
в корневой папке.
В нём указывается несколько переменных среды:

- `STAGEI_BIN` - путь к утилите распознавания КТЭ
- `TURRET_BIN` - путь к утилите выбора инструмента и режима резания
- `LATHE_JOB` - при запуске утилиты без параметров
  в качестве входного файла будет использован указанный файл
  из папки [data/var](../../data/var/)
- `NCP_OUT` - если указано,
  то генерируемые управляющие программы будут помещаться в эту папку;
  при повторном запуске утилиты эти файлы будут перезаписаны без предупреждения
- `TURRET_LOGS` - если указано,
  то в этой папке будет создаваться журнал
  вызовов утилиты выбора инструмента

Пример файла `.env`:
```
STAGEI_BIN=E:\My\Repo\kte.wiki\Kaz\NPRecognition.exe
TURRET_BIN=E:\My\Repo\kte.wiki\Bog\instr_regim.exe
LATHE_JOB=14
NCP_OUT=bundle
TURRET_LOGS=bundle/logs
```
